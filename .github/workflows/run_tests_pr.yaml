- name: Send report to Slack
  if: always()
  uses: slackapi/slack-github-action@v1.25.0
  with:
    payload: |
      {
        "blocks": [
          {
            "type": "header",
            "text": {
              "type": "plain_text",
              "text": "‚öôÔ∏è QA Automation",
              "emoji": true
            }
          },
          {
            "type": "section",
            "fields": [
              {
                "type": "mrkdwn",
                "text": "*Status:* ${{ job.status == 'success' && 'PASSED üü©' || 'FAILED üü•' }}"
              },
              {
                "type": "mrkdwn",
                "text": "*Test Report Name:*\nPlaywright Report"
              }
            ]
          },
          {
            "type": "section",
            "fields": [
              {
                "type": "mrkdwn",
                "text": "*Environment:*\n${{ env.ENVIRONMENT }}"
              },
              {
                "type": "mrkdwn",
                "text": "*Triggered by:*\n${{ github.actor }}"
              }
            ]
          },
          {
            "type": "section",
            "text": {
              "type": "mrkdwn",
              "text": "*üìÑ Playwright Report:*\n<${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}#artifacts|Click to open report>"
            }
          },
          {
            "type": "context",
            "elements": [
              {
                "type": "mrkdwn",
                "text": "Repository: `${{ github.repository }}`  ‚Ä¢  Branch: `${{ github.ref_name }}`"
              }
            ]
          }
        ]
      }
  env:
    SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
    ENVIRONMENT: CI
